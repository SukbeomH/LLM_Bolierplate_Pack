# Technology Stack

> Generated by /map on 2026-01-28 (updated)

## Runtime

| Technology | Version | Purpose |
|---|---|---|
| Python | >=3.11 | Primary language |
| uv | latest | Package manager (pip/poetry 대체) |
| Docker | latest | Memgraph 컨테이너 관리 |
| direnv | latest | `.env` 자동 로드 (`.envrc` → `dotenv`) |

## Production Dependencies

| Package | Version | Purpose |
|---|---|---|
| mcp | >=1.0.0 | Model Context Protocol SDK |

## Development Dependencies

| Package | Version | Purpose |
|---|---|---|
| pytest | >=8.0 | 테스트 프레임워크 |
| ruff | >=0.8 | 린터 + 포매터 (9종 규칙) |
| mypy | >=1.13 | 정적 타입 체커 |

## External Tools (Non-Python)

| Tool | Purpose | Install |
|---|---|---|
| code-graph-rag | Tree-sitter + Memgraph AST 분석 MCP 서버 | `make install-code-graph-rag` / [GitHub](https://github.com/vitali87/code-graph-rag) |
| memory-graph | 에이전트 영구 기억 MCP 서버 | `make install-memorygraph` / `pipx install memorygraphMCP` |
| Memgraph | code-graph-rag 그래프 DB 백엔드 | Docker (`make up`) |
| gh CLI | GitHub PR/Issue 관리 | `brew install gh` (optional) |

## Infrastructure

| Service | Provider | Purpose | Port |
|---|---|---|---|
| Memgraph | Docker (memgraph/memgraph-platform) | code-graph-rag 백엔드 | 7687 (Bolt), 7444 (Lab) |

**Docker Volume:** `memgraph-data` (persistent)
**Restart Policy:** unless-stopped

## MCP Servers

| Server | Transport | Tools | Purpose |
|---|---|---|---|
| graph-code | stdio | `query_code_graph`, `index_repository` | AST 기반 코드 분석 |
| memorygraph | stdio | `store_memory`, `recall_memories`, `search_memories`, `create_domain`, `select_domain` | 에이전트 영구 기억 |
| Context7 | HTTP | library docs lookup | 라이브러리 문서 조회 |

**Feature:** `enable_tool_search: true` (도구 탐색 활성화)

## IDE

| Extension | ID | Purpose |
|---|---|---|
| Ruff | charliermarsh.ruff | 린터 + 포매터 (네이티브 서버) |
| Python | ms-python.python | 인터프리터, 디버깅 |
| Mypy Type Checker | ms-python.mypy-type-checker | 타입 체크 (dmypy daemon) |
| Ruff Ignore Explainer | jannchie.ruff-ignore-explainer | 규칙 설명 인라인 표시 |

## Code Quality Configuration

| Tool | Config Location | Key Settings |
|---|---|---|
| Ruff | `pyproject.toml` | E,F,I,N,W,B,C90,PL,TC / line-length=100 / McCabe<=10 / max-args=6 / max-returns=6 / max-statements=50 |
| Mypy | `pyproject.toml` | python_version=3.11, warn_return_any=true, warn_unused_configs=true |
| Pytest | `pyproject.toml` | testpaths=["tests"] |
| VS Code | `.vscode/settings.json` | Ruff native server, format-on-save, 100-char ruler, mypy daemon |

**Naming Exceptions:** `*Factory`, `Create*` (N 규칙 면제)
**Ignored Rules:** E501 (line-length), PLR2004 (magic-value-comparison)
**Excluded Dirs:** awesome-claude-code, claude-code-tips, everything-claude-code, ralph

## Configuration

| Variable | Purpose | Required | Default |
|---|---|---|---|
| PROJECT_ID | 프로젝트 식별자 | Yes | `my_project` |
| CODE_GRAPH_RAG_PATH | code-graph-rag 설치 경로 | Yes | `${HOME}/code-graph-rag` |
| TARGET_REPO_PATH | code-graph-rag 분석 대상 경로 | Yes | `.` |
| CYPHER_PROVIDER | Cypher 생성 LLM 프로바이더 | Yes | `google` |
| CYPHER_MODEL | Cypher 생성 모델 | Yes | `gemini-2.0-flash` |
| CYPHER_API_KEY | LLM API 키 | Yes | — |
| CONTEXT7_API_KEY | Context7 MCP 서버 인증 | No | — |
| MEMORY_BACKEND | memory-graph 스토리지 백엔드 | No | `sqlite` |
| MEMORY_TOOL_PROFILE | memory-graph 도구 프로필 | No | `extended` |
| DISABLE_AUTOUPDATER | Claude CLI 자동 업데이트 비활성화 | No | `0` |
| SSL_CERT_FILE | TLS 인증서 (기업 프록시 환경) | No | — |

## Build & Run Commands

```bash
# Full Setup (one command)
make setup                    # install-deps → init-env → up → index

# Prerequisites Check
make check-deps               # docker, uv, pipx 확인

# Installation
make install-code-graph-rag   # Clone/update code-graph-rag
make install-memorygraph      # pipx install memorygraphMCP
make install-deps             # 모든 외부 의존성 설치
make init-env                 # .env.example → .env 생성

# Infrastructure
make up / make down           # Memgraph 시작/중지
make status / make logs       # 상태/로그

# Code Indexing
make index                    # code-graph-rag 인덱싱 (.graph-index/)

# Code Quality
make lint / make lint-fix     # Ruff 린트/자동수정
make test                     # Pytest 실행
make typecheck                # Mypy 타입체크
make validate                 # SPEC 구조 검증

# System Prompt Patching
make patch-prompt             # Claude CLI 시스템 프롬프트 패치 (~50% 토큰 절감)
make patch-restore            # 원본 복원
make patch-clean              # 패치 워크스페이스 삭제

# Cleanup
make clean                    # Docker volume + index + patch workspace 삭제
```

## File Inventory

| Category | Count | Location |
|---|---|---|
| GSD Workflows | 29 | `.agent/workflows/` |
| Claude Skills | 14 | `.claude/skills/` |
| GSD Templates | 22 | `.gsd/templates/` |
| GSD Examples | 3 | `.gsd/examples/` |
| GSD Documents | 8 | `.gsd/` (SPEC, ARCHITECTURE, STACK, STATE, JOURNAL, DECISIONS, ROADMAP, TODO) |
| GitHub CI | 1 | `.github/workflows/ci.yml` |
| Issue Templates | 3 | `.github/ISSUE_TEMPLATE/` |
| Test Files | 3 | `tests/` (conftest + test_sample + __init__) |
| Scripts | 1 | `scripts/validate_spec.py` |
| Config Files | 9 | Root (pyproject.toml, .mcp.json, Makefile, docker-compose.yml, .env.example, .envrc, .gitignore, CLAUDE.md, README.md) |
| VS Code | 2 | `.vscode/` (settings.json, extensions.json) |
| **Total** | **~100** | Boilerplate only |
