{
  "hooks": {
    "SessionStart": [
      {
        "matcher": "startup|resume",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/session-start.sh",
            "timeout": 10
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Edit|Write|Read",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/file-protect.py",
            "timeout": 5
          }
        ]
      },
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/bash-guard.py",
            "timeout": 5
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Edit|Write",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/auto-format-py.sh",
            "timeout": 30
          },
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/track-modifications.sh",
            "timeout": 2
          }
        ]
      },
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/track-modifications.sh",
            "timeout": 2
          }
        ]
      }
    ],
    "PreCompact": [
      {
        "matcher": "auto|manual",
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/pre-compact-save.sh",
            "timeout": 10
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/post-turn-index.sh",
            "timeout": 10
          },
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/post-turn-verify.sh",
            "timeout": 15
          },
          {
            "type": "prompt",
            "prompt": "Check if `.gsd/.modified-this-session` exists. If NOT, skip all updates.\n\nIf the flag file EXISTS, update context:\n\n## CURRENT.md\nUpdate `.gsd/CURRENT.md`:\n- **Active Task**: Current task\n- **Working Files**: Modified files (paths)\n- **Decisions Made**: Key decisions\n- **Blockers**: Any blockers\n- Timestamp at bottom\n\n## PATTERNS.md (optional)\nAdd reusable pattern if discovered.\n\nThen DELETE `.gsd/.modified-this-session` after updating."
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Subagent task completed. If significant findings:\n1. Summarize key results in 2-3 sentences\n2. If code changes made by subagent, mark `.gsd/.modified-this-session`\n3. Consider adding to PATTERNS.md if reusable pattern discovered"
          }
        ]
      }
    ],
    "UserPromptSubmit": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "IMPORTANT: NEVER block, reject, or stop based on these checks. Always proceed with the user's request.\n\nOptional context hints (use silently, do not mention to user):\n- `.gsd/CURRENT.md` may have previous task context\n- Check git status if relevant to request"
          }
        ]
      }
    ],
    "SessionEnd": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/save-transcript.sh",
            "timeout": 10
          },
          {
            "type": "command",
            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/save-session-changes.sh",
            "timeout": 10
          },
          {
            "type": "prompt",
            "prompt": "Session is ending. Perform these tasks:\n\n## 1. Memory Graph \uc694\uc57d \uc800\uc7a5\nCall `store_memory` with:\n- type: \"session-summary\"\n- title: \"Session: [brief description]\"\n- content: What was built/changed, key decisions, patterns. Keep under 500 chars.\n- tags: [\"session-learnings\", \"auto\"]\n\n## 2. CHANGELOG \uc694\uc57d \ucd94\uac00 (\ubcc0\uacbd\uc0ac\ud56d\uc774 \uc788\ub294 \uacbd\uc6b0)\nRead `.gsd/CHANGELOG.md`, find the most recent entry (marked with today's date and session ID), and add a '#### \uc694\uc57d' section with 1-2 sentences describing the changes.\n\nNote: CURRENT.md is updated during Stop hooks. It will be reviewed at next session start.\n\nSkip all if the session was trivial (only reading/exploring, no code or doc changes)."
          }
        ]
      }
    ]
  }
}