{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Security Audit Skill Schema",
  "description": "보안 감사 스킬의 입력/출력 인터페이스 정의",
  "type": "object",
  "properties": {
    "input": {
      "type": "object",
      "description": "스킬 입력 파라미터",
      "properties": {
        "target_directory": {
          "type": "string",
          "description": "프로젝트 루트 디렉토리 경로 (선택적)"
        }
      },
      "additionalProperties": false
    },
    "output": {
      "type": "object",
      "description": "스킬 출력 결과",
      "properties": {
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "감사 실행 시각 (ISO 8601 형식)"
        },
        "stack": {
          "type": "string",
          "enum": ["python", "node"],
          "description": "감지된 프로젝트 스택"
        },
        "packageManager": {
          "type": "string",
          "enum": ["npm", "pnpm", "yarn", "poetry", "uv"],
          "description": "사용된 패키지 매니저"
        },
        "audit": {
          "type": "object",
          "description": "보안 감사 결과",
          "properties": {
            "stack": {
              "type": "string",
              "enum": ["python", "node"]
            },
            "tool": {
              "type": "string",
              "enum": ["safety", "npm", "pnpm"],
              "description": "사용된 보안 감사 도구"
            },
            "status": {
              "type": "string",
              "enum": ["secure", "vulnerable", "error", "tool_not_found", "not_supported"],
              "description": "감사 결과 상태"
            },
            "vulnerabilities": {
              "type": "array",
              "description": "발견된 취약점 목록",
              "items": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "취약한 패키지 이름"
                  },
                  "severity": {
                    "type": "string",
                    "description": "취약점 심각도"
                  },
                  "title": {
                    "type": "string",
                    "description": "취약점 제목"
                  },
                  "url": {
                    "type": "string",
                    "format": "uri",
                    "description": "상세 정보 URL"
                  }
                },
                "additionalProperties": true
              }
            },
            "errors": {
              "type": "array",
              "description": "오류 메시지 목록",
              "items": {
                "type": "string"
              }
            },
            "message": {
              "type": "string",
              "description": "상태 메시지 (not_supported인 경우)"
            }
          },
          "required": ["stack", "tool", "status"],
          "additionalProperties": true
        }
      },
      "required": ["timestamp", "stack", "packageManager", "audit"],
      "additionalProperties": false
    }
  }
}

